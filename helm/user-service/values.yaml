# Default values for user-service Helm chart

replicaCount: 3

image:
  repository: user-service
  tag: "1.0.0"
  pullPolicy: IfNotPresent

imagePullSecrets: []

namespace:
  create: true
  name: user-service

serviceAccount:
  create: true
  annotations: {}
  name: ""

service:
  type: ClusterIP
  port: 8000
  targetPort: 8000
  name: http

resources:
  requests:
    cpu: 200m
    memory: 256Mi
  limits:
    cpu: 1
    memory: 1Gi

autoscaling:
  enabled: false
  minReplicas: 2
  maxReplicas: 10
  targetCPUUtilizationPercentage: 75
  targetMemoryUtilizationPercentage: 80

livenessProbe:
  enabled: true
  httpGet:
    path: /health
    port: 8000
  initialDelaySeconds: 10
  periodSeconds: 30
  timeoutSeconds: 5
  failureThreshold: 3

readinessProbe:
  enabled: true
  httpGet:
    path: /health
    port: 8000
  initialDelaySeconds: 5
  periodSeconds: 10
  timeoutSeconds: 3
  failureThreshold: 2

env:
  LOG_LEVEL: info
  DATABASE_TYPE: sqlite
  DB_PATH: /app/data/users.db

configMap:
  enabled: true
  data:
    APP_ENV: production
    LOG_LEVEL: INFO
    DATABASE_TYPE: sqlite
    DB_PATH: /tmp/users.db

secretKey: ""
secrets:
  enabled: true
  secretKey: "set-via-helm-or-secret-manager"

database:
  type: sqlite
  path: /app/data/users.db

persistence:
  enabled: false
  storageClass: local-path
  accessMode: ReadWriteOnce
  size: 10Gi
  mountPath: /app/data

affinity: {}
nodeSelector: {}
tolerations: []
podAnnotations: {}

podLabels:
  app: user-service
  version: v1

podSecurityContext:
  fsGroup: 1000

securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL
  readOnlyRootFilesystem: true
  runAsNonRoot: true
  runAsUser: 1000

monitoring:
  enabled: false
  prometheus:
    enabled: false
    port: 9090

strategy:
  type: RollingUpdate
  rollingUpdate:
    maxSurge: 1
    maxUnavailable: 0

dnsPolicy: ClusterFirst
restartPolicy: Always
terminationGracePeriodSeconds: 30

kong:
  jwtSecretName: user-service-jwt
  host: user-service.example.com
  allowedCIDRs:
    - "127.0.0.1/32"
  plugins:
    - jwt-user-service
    - custom-trace
    - rate-limit-ip
    - ip-whitelist

waf:
  enabled: false
  image:
    repository: owasp/modsecurity-crs
    tag: latest
  mode: DetectionOnly
  rules:
    - "SecRule REQUEST_HEADERS:User-Agent \"sqlmap\" \\
        \"id:1000001,phase:1,deny,log,msg:'Blocked sqlmap UA'\""
  servicePort: 80

envSecrets:
  - name: SECRET_KEY
    key: secret-key

volumes: []
initContainers: []
sidecarContainers: []

app:
  port: 8000
  debug: false
  workers: 1
